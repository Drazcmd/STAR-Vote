= !VoteBox Software Specification: Preparation Tool =
[[PageOutline]]

[[Image(VoteBoxPrepTool/Screenshots:preptool-pres.png, 400)]]


'''Kyle Derr, Daniel Sandler, Corey Shaw, Ted Torous'''

''Written by: Corey Shaw''

'''See Also:'''
 * The [VoteBoxPrepTool/Guide User Guide], a quick overview of the Preparation Tool's features
 * Readers are encouraged to use the !JavaDoc (checked into the repository [https://sys.cs.rice.edu/repos/seclab/projects/ballotbox/java/preptool/trunk/javadoc here]) as a more specific guide to the program's API.

== Introduction ==
The !VoteBox Preparation Tool is designed to be used in conjunction with the [VoteBoxRunTime VoteBox Runtime].  Its primary purpose is to allow the user to build a ballot from scratch (or a premade one) and then export it to disk so it can be fed into the !VoteBox Runtime.  The Preparation Tool is designed to be a full-featured editor, meaning the user can save a ballot, and then reopen and make changes later.  With this tool, the user can add, remove, and reorder races, enter candidates and other information in multiple languages, and preview the current race or even the entire ballot.

One goal of developing this tool was to provide a nice, simple interface that would allow a user to enter information in a dynamic and familiar interface, so that the ballots could be created with little headache.  However, this could have been (marginally) accomplished by specifying an XML or text file format that the user would have to learn and enter directly: it would not be quite as user friendly, but the need for this tool would have been diminished.  In fact, an even larger goal for this tool was to be able to have a ballot format that consists only of images prerendered to disk, with a pair of XML files describing the ballot and the layout (locations of those images).  This way, no text is stored anywhere in the ballot definition; since all text is prerendered on the images, only the unique ID's of the components of the ballot and the layout need to be linked.  See [http://zesty.ca/pubs/yee-wagner-hearst-bellovin-prui-usenix2006.pdf Yee06] for further description of prerendered ballots.

== Modules ==

There are three main components in the implementation of the Preparation Tool: the Model, the !LayoutManager, and the View.  The Model contains the definition of the ballot and the layout hierarchies.  The !LayoutManager takes a ballot and makes a layout from it; it also manages rendering of images.  The View is the interface that the user interacts with, for performing editing and other operations on the ballot.  In addition, there is a Controller that initializes and links the Model and View together, but because it does little more than that, a more lengthy description has been elided.

=== The Model ===
''See the [VoteBoxPrepTool/Model Model] sub-page for more information.''

The Model is the underlying implementation of the program; that is, any of the data structures and algorithms associated with the program's state are in the Model.  The Model consists of the Ballot and the Layout.  The Ballot is held in memory: it is loaded and saved to disk, and is changed whenever the user edits it in the UI.  It holds all of the races and the candidates participating in those races.  The Layout describes the images that are to be rendered for that Ballot, and the locations and types of those images.  The Layout is never held in memory for a long period of time - it is generated by the !LayoutManager on request, and is used to write the XML and render the images, and then thrown away once the operation is complete.

=== The !LayoutManager ===
''See the [VoteBoxPrepTool/LayoutManager Layout Manager] sub-page for more information.''

The !LayoutManager has one main purpose purposes: to produce a Layout that corresponds to a given Ballot.  As such, it is specified by the ILayoutManager interface, whose one method makeLayout does exactly that.  A concrete implementation of the !LayoutManager may use any number of ways to lay out its pages, and may create whatever pages it likes.  A standard method, used by the ALayoutManager abstract class and the [VoteBoxPrepTool/PsychLayout PsychLayoutManager] implementation, uses Swing's !GridBagLayout to position the elements on a frame, and then copying the positions where they end up onto the elements themselves.

=== The View ===
''See the [VoteBoxPrepTool/View View] sub-page for more information.''