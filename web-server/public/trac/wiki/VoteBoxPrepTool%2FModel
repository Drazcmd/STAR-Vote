= !VoteBox Software Specification: Preparation Tool Model =
'''Kyle Derr, Daniel Sandler, Corey Shaw, Ted Torous'''

''Written by: Corey Shaw''

Parent: VoteBoxPrepTool

[[PageOutline]]

== Top Level Overview ==
The Model is the underlying implementation of the program; that is, any of the data structures and algorithms associated with the program's state are in the Model.  The Model consists of the Ballot and the Layout.  (The Model also contains the [VoteBoxPrepToolLayoutManager LayoutManager], but it has its own page.) The Ballot is held in memory: it is loaded and saved to disk, and is changed whenever the user edits it in the UI.  It holds all of the races and the candidates participating in those races.  The Layout describes the images that are to be rendered for that Ballot, and the locations and types of those images.  The Layout is never held in memory for a long period of time - it is generated by the !LayoutManager on request, and is used to write the XML and render the images, and then thrown away once the operation is complete.

The main reason for the decision to have separate Ballot and Layout hierarchies was to decouple the Ballot and the Layout.  Now the only thing that needs to be stored in the Ballot is the list of races and candidates, while sizing and position information is strictly in the Layout.  (Previously, all of the information was stored in one place so it was easy to get confused.)  In addition, a common layout would be to have an instructions page before any of the races.  This instructions page would exist nowhere on the Ballot, but the !LayoutManager would add it as part of the Layout.  Both the Ballot and the Layout can also recursively convert their structures to XML.

== Ballot ==
Ballot is the top-level class for representing the ballot that the user is currently working on.  It contains the list of cards (which represent races or propositions) that are in the ballot.  It also may have some members that deal with saving, exporting, and laying out the Ballot.

See VoteBoxRunTime#Ballot for more information about the Ballot representation.

=== Card ===
A card (implemented by the ACard class) is the abstract representation of a choice that the user must make, that lies in the ballot.  Each contains several card elements that represent the options the user has to choose from.  There are currently three types of cards:
 * !RaceCard (a normal race, with single candidates)
 * !PresidentialRaceCard (a race that has two candidates for each element)
 * !PropositionCard (a proposition with a long description)

Adding a new type of card is simple: just extend the ACard class (specifying the type of element to use; see below), or any of its subclasses.  However, for the new type of card to have different behavior in rendering and sizing, a corresponding method will need to be added in the ICardVisitor class, and all implemented !LayoutManagers will need to be updated.

=== Card Element ===
A card element (implemented by the ACardElement class) is an option the user can choose from on a card.  Every type of card has a specific type of card element.  The two types of card elements are as follows:
 * !OneLineCardElement (used by !RaceCard and !PropositionCard), and
 * !TwoLineCardElement (used by !PresidentialRaceCard to reflect the two candidates running)

To add a new type of card element, simply extend the ACardElement class or any of its subclasses, and then modify or create an ACard type to use the new card element.

== Layout ==
Layout is the top level class containing all information about the layout of a Ballot.  It contains a list of Pages that are mostly ordered in the way the user would go through them.

=== Page ===
A Page represents the collection of images that a user might see at some point in time when using !VoteBox.  For instance, a Race screen might have a title, the position, clickable buttons for the candidates, and next and previous page buttons for navigation.  The Page simply holds an array of these components - each component knows its own size and position on the page.

=== Layout Components ===
A layout component (implemented by the ALayoutComponent abstract class) is something that can go on a Page.  Behavior that is common to all ALayoutComponents includes the knowledge of the current size, location, and relative position to other ALayoutComponents.  Several types of these components are listed below.  See the classes' Javadocs for more detailed descriptions of the APIs.

 Label::
  A string of text displayed somewhere on the screen, such as a title
 Button::
  A button that the user can click on, and the appropriate action to take, such as a next page button
 !ToggleButtonGroup::
  A group of !ToggleButtons, and the behavior of these buttons when clicked
 !ToggleButton::
  A button that can be toggled on or off, such as a candidate's name (usually part of a !ToggleButtonGroup)
 Background::
  An image that is the background of a page

Rendering and other operations on layout components can be accomplished with the ILayoutComponentVisitor.